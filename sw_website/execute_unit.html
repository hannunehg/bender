
<div style="padding-right: 10px">
	<div id="body" style="vertical-align: center">
		<br> 
		<span class="button_style" id="lblUnitName">
	</div>
	<div class="progress" style="width: 1000px;">
	<div id="ProgresBarDivID" class="progress" style="width: 100%;">
		<div id="progressBarID" class="progress-bar progress-bar-striped active"  role="progressbar" aria-valuemin="0" aria-valuemax="10" style="width: 0%">
		</div>
	</div>
</div>

<script type="text/javascript">

	function createConfigurationFiles(unitID, unitnumber, rodsnumber, rodsthickness){
		var status = "ERR";
		console.log("createConfigurationFile API");
		
		var Data = {};
		Data['unitID'] = unitID;
		Data['unitnumber'] = unitnumber;
		Data['rodsnumber'] = rodsnumber;
		Data['rodsthickness'] = rodsthickness;
	
		var xhr = $.ajax({
			url: 'unit_manipluation.php',
			type: 'GET',
			data: Data,
			async:false,
			cache: false,
			success: function(response) 
			{ 
				console.log("returned json from getUnitInformation operation = " + response);
				var parsedJSON = eval('('+response+')');
				status = "OK";
			}
		});
		return status;
	}
	
	$(document).ready(function(){
		
		//Creating the unit information (name and pieces)
		console.log('executing unitID = ' + unitID);
		console.log('unitnumber = ' + unitnumber);
		console.log('rodsnumber = ' + rodsnumber);
		console.log('rodsthickness = ' + rodsthickness);
							
		var unit_name = getUnitName(unitID);
		console.log('executing unit_name = ' + unit_name);
		var pieces = getAllPieces(unitID);
		for (i = 0; i < pieces.length; i++) {
			pieces[i].logInformation();
		}
		
		//Creating table that describes the pieces
		var html = "";
		html += "<br><br><table id='myTable' class='tablesorter'><thead>";
		html += "<th> الترتيب </th>";
		html += "<th>  الطول بالسنتميتر</th>";
		html += "<th>  الزاوية </th>" ;
		html += "</thead><tbody>";
		for (i = 0; i < pieces.length; i++) { 
			var seq = pieces[i].seq_number;
			html += "<tr>";
			html += "<td class ='column_style' style='font-size: 15pt'>" + eval(seq+1) +"</td>";
			html += "<td class ='column_style' style='font-size: 15pt'>" + pieces[i].dimension + "</td>" ;
			html += "<td class ='column_style' style='font-size: 15pt'>" + pieces[i].angle + "</td>" ;
			html += "</tr>";
		}
		html += "</tbody></table><br>";
		document.getElementById('body').innerHTML += html;
		document.getElementById('lblUnitName').innerHTML +=  unit_name;
		
		//Creating configuration file
		var status = createConfigurationFiles(unitID, unitnumber, rodsnumber, rodsthickness);
		if (status != "OK")
		{
			showAlert("حدث خطأ أثناء محاولة التحضير لتشغيل الآلة");
		}
		
		//var progressDiv = document.getElementById('ProgresBarDivID').style.width;
		//console.log(" -- " + progressDiv);
		
		setTimeout(updateProgressBar, 500);
	});
	
	function updateProgressBar(){
		var w = parseInt(document.getElementById('progressBarID').style.width);
		document.getElementById('progressBarID').style.width = (w + 20) +'%';
		console.log(document.getElementById('progressBarID').style.width);
		
		if (document.getElementById('progressBarID').style.width != "100%")
		{
			setTimeout(updateProgressBar, 500);
		}
	}
</script>


	